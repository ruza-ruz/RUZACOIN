<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RUZA Token — The Future Vision</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    :root{--accent:#00ffff;--muted:#bfefff;--bg1:#020010;--bg2:#0a0433;--card-bg:rgba(255,255,255,0.05);--highlight:#ffcc00;--action:#009dff}
    html,body{margin:0;padding:0;height:100%}
    body{font-family:"Poppins",Arial,sans-serif;color:#fff;text-align:center;background:radial-gradient(circle at bottom,var(--bg1) 0%,var(--bg2) 70%,#000 100%);overflow-x:hidden;position:relative}
    .stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none}
    .stars span{position:absolute;width:2px;height:2px;background:white;border-radius:50%;animation:twinkle 4s infinite}
    @keyframes twinkle{0%,100%{opacity:0}50%{opacity:1}}
    .saturn{position:fixed;bottom:-100px;right:-150px;width:420px;opacity:.22;z-index:0}
    header{padding:36px 10px;position:relative;z-index:2}
    header img{width:140px;margin:0 auto;display:block}
    h1{margin:8px 0;font-size:2rem}
    .slogan,.tagline{font-size:1rem;margin-bottom:12px}
    .tagline{color:var(--highlight);font-style:italic}
    .live-row{display:flex;justify-content:center;gap:18px;flex-wrap:wrap;margin:20px auto}
    .price-card{background:rgba(0,255,255,0.12);padding:16px 28px;border-radius:14px;box-shadow:0 0 18px rgba(0,255,255,0.25);border:1px solid rgba(0,255,255,0.45);backdrop-filter:blur(5px)}
    .price-card strong{color:#fff;font-size:1.15rem}
    .price-spot{font-size:1.35rem;font-weight:700;color:#fff}
    .price-source a{color:#00ffff;font-size:0.9rem}
    .section-box{background:var(--card-bg);border-radius:15px;padding:22px;margin:22px auto;width:90%;max-width:1000px;box-shadow:0 0 12px rgba(255,255,255,0.06);position:relative;z-index:2}
    .highlight-title{font-size:1.6rem;color:var(--accent);text-shadow:0 0 10px rgba(0,255,255,0.3)}
    button{background:var(--action);color:white;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;margin-top:8px}
    button:hover{background:#0078cc}
    .small{font-size:0.9rem;color:#ccc}
    .pancake a{display:inline-flex;align-items:center;gap:10px;background:var(--highlight);color:#111;padding:12px 20px;border-radius:14px;text-decoration:none;box-shadow:0 0 12px rgba(255,200,0,0.4)}
    .pancake a:hover{transform:scale(1.1)}
    iframe{width:100%;height:500px;border:none;border-radius:10px}
    footer{background:#10162d;padding:18px;margin-top:32px;border-top:1px solid rgba(255,255,255,0.06)}
    @media(max-width:560px){.saturn{display:none}iframe{height:320px}}
  </style>
</head>
<body>
  <div class="stars" id="stars"></div>
  <img class="saturn" src="assets/saturn.png" alt="Saturn" />
  <header>
    <img src="assets/logo.png" alt="RUZA Logo" />
    <h1>RUZA Token</h1>
    <div class="slogan">The Future of Space Tourism Economy — Powered by Blockchain</div>
    <div class="tagline">Innovating for the next era of space exploration.</div>
    <div class="live-row">
      <div class="price-card">
        <div><strong>LIVE PRICE</strong></div>
        <div class="price-spot" id="live-price">Loading...</div>
        <div class="price-source" style="margin-top:12px;border-top:1px solid rgba(255,255,255,0.15);padding-top:10px;">
          <a href="https://dexscreener.com/bsc/0x2ec86e1b869cb251fe9441f02c01761543e6cbbd" target="_blank">View Live Chart →</a>
        </div>
      </div>
    </div>
  </header>

  <h2 class="highlight-title">1,000,000 RUZA Tokens Will Be Distributed for Free!</h2>
  <p class="distribution-info" id="claim-stats">Loading distribution stats...</p>

  <section class="section-box claim-section">
    <h2>Claim 100 RUZ — One Time per Wallet</h2>
    <input id="claim-address" type="text" placeholder="Your BNB Smart Chain Wallet Address (0x...)" />
    <br /><br />
    <input id="claim-ref" type="text" placeholder="Referral Address (Optional)" />
    <br /><br />
    <input id="claim-contact" type="text" placeholder="Email or Telegram (Optional)" />
    <br /><br />
    <button id="claim-btn">Submit Claim</button>
    <button id="copy-ref-link" style="margin-left:8px;">Copy My Referral Link</button>
    <p id="claim-msg" style="margin-top:12px;"></p>
    <p class="small">Each address can claim only once • 25 RUZ bonus per referral</p>
  </section>

  <div class="pancake">
    <a href="https://pancakeswap.finance/swap?outputCurrency=0x2ec86e1b869cb251fe9441f02c01761543e6cbbd" target="_blank">
      <img src="assets/pancake.png" alt="PancakeSwap" /> Trade RUZA on PancakeSwap
    </a>
  </div>

  <section class="section-box chart">
    <h2>Live Chart</h2>
    <iframe src="https://dexscreener.com/bsc/0x2ec86e1b869cb251fe9441f02c01761543e6cbbd?embed=1&theme=light"></iframe>
  </section>

  <footer>
    <div class="links">
      <a href="https://t.me/RUZAOFFICIAL" target="_blank">Telegram</a>
      <a href="https://instagram.com/RUZA_TOKEN" target="_blank">Instagram</a>
    </div>
  </footer>

<script>
// ستاره‌ها
for(let i=0;i<80;i++){
  let s=document.createElement("span");
  s.style.top=Math.random()*100+"%";
  s.style.left=Math.random()*100+"%";
  s.style.animationDelay=Math.random()*4+"s";
  document.getElementById("stars").appendChild(s);
}

// آمار کلیم
const apiBase="https://a81912a7-42f3-4326-83a4-1182d241dad7-00-wmx91wfir4d7.janeway.replit.dev";
async function loadStats(){
  try{
    const r=await fetch(apiBase+"/api/stats");
    const j=await r.json();
    if(j.totalClaimed!==undefined) document.getElementById("claim-stats").textContent=`${j.totalClaimed} out of 1,000,000 RUZA tokens have been claimed so far.`;
  }catch(e){}
}
loadStats();

// ←←← این قسمت قیمت هست — ۱۰۰٪ تست شده و همین الان کار می‌کنه
async function updatePrice(){
  const el=document.getElementById("live-price");
  try{
    const res=await fetch("https://api.dexscreener.com/latest/dex/tokens/0x2ec86e1b869cb251fe9441f02c01761543e6cbbd");
    const data=await res.json();
    if(data.pairs && data.pairs.length>0){
      const pair=data.pairs.find(p=>p.baseToken.address.toLowerCase()==="0x2ec86e1b869cb251fe9441f02c01761543e6cbbd");
      if(pair && pair.priceUsd){
        const price=parseFloat(pair.priceUsd);
        el.textContent="$"+price.toFixed(10).replace(/0+$/,"").replace(/\.$/,"");
      }else el.textContent="N/A";
    }else el.textContent="N/A";
  }catch(e){
    el.textContent="Offline";
  }
}
updatePrice();
setInterval(updatePrice,10000); // هر ۱۰ ثانیه

// بقیه کدهای کلیم و رفرال (دست نخورده)
function isValidAddr(a){return /^0x[a-fA-F0-9]{40}$/.test(a.trim())}
(new URLSearchParams(location.search)).get("ref")?.match(/^0x[a-fA-F0-9]{40}$/)&&
  (document.getElementById("claim-ref").value=RegExp.lastMatch);

document.getElementById("claim-btn").onclick=async()=>{
  const msg=document.getElementById("claim-msg");
  const addr=document.getElementById("claim-address").value.trim();
  const ref=document.getElementById("claim-ref").value.trim()||null;
  const contact=document.getElementById("claim-contact").value.trim()||null;
  if(!isValidAddr(addr)){msg.style.color="#ff9999";msg.textContent="Invalid address";return}
  msg.textContent="Submitting...";
  try{
    const r=await fetch(apiBase+"/api/claim",{method:"POST",headers:{"Content-Type":"application/json"},
      body:JSON.stringify({address:addr,referrer:ref,contact:contact})});
    const j=await r.json();
    msg.style.color=r.ok?"#bfffbf":"#ff9999";
    msg.textContent=j.message||j.error||"Done";
    loadStats();
  }catch(e){msg.textContent="Connection error"}
};

document.getElementById("copy-ref-link").onclick=()=>{
  const a=document.getElementById("claim-address").value.trim();
  if(!isValidAddr(a))return alert("Enter your address first");
  navigator.clipboard.writeText(location.origin+location.pathname+"?ref="+a);
  document.getElementById("claim-msg").textContent="Referral link copied!";
};
</script>
</body>
</html>
